local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UIS = game:GetService("UserInputService")

local player = Players.LocalPlayer
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.Name = "MobileESPUI"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true

--  Panel Frame
local panel = Instance.new("Frame")
panel.Size = UDim2.new(0, 200, 0, 120)
panel.Position = UDim2.new(0, 20, 0, 20)
panel.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
panel.BackgroundTransparency = 0.2
panel.BorderSizePixel = 0
panel.Active = true
panel.Draggable = false -- replaced with custom drag
panel.Parent = gui

--  ESP Toggle Button
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(1, -20, 0, 40)
toggleButton.Position = UDim2.new(0, 10, 0, 10)
toggleButton.Text = "Enable ESP"
toggleButton.BackgroundColor3 = Color3.fromRGB(50, 50, 255)
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.TextScaled = true
toggleButton.Font = Enum.Font.GothamBold
toggleButton.Parent = panel

--  Randomize Button
local randomButton = Instance.new("TextButton")
randomButton.Size = UDim2.new(1, -20, 0, 40)
randomButton.Position = UDim2.new(0, 10, 0, 60)
randomButton.Text = "Randomize"
randomButton.BackgroundColor3 = Color3.fromRGB(50, 200, 100)
randomButton.TextColor3 = Color3.new(1, 1, 1)
randomButton.TextScaled = true
randomButton.Font = Enum.Font.GothamBold
randomButton.Parent = panel

--  Credit Label
local credit = Instance.new("TextLabel", gui)
credit.Text = "Made by Eulo"
credit.Size = UDim2.new(0, 200, 0, 30)
credit.Position = UDim2.new(1, -210, 1, -40)
credit.BackgroundTransparency = 1
credit.TextColor3 = Color3.new(1, 1, 1)
credit.TextScaled = true
credit.Font = Enum.Font.GothamSemibold
credit.TextStrokeTransparency = 0.5

--  ESP Toggle Logic
local espEnabled = false
local function toggleESP()
    espEnabled = not espEnabled
    toggleButton.Text = espEnabled and "Disable ESP" or "Enable ESP"

    for , egg in pairs(Workspace:GetChildren()) do
        if egg:IsA("Model") and egg:FindFirstChild("Egg") then
            local gui = egg.Egg:FindFirstChild("PetTypeGui")
            if gui then
                gui.Enabled = espEnabled
            end
        end
    end
end

toggleButton.MouseButton1Click:Connect(toggleESP)

--  Randomizer Logic
randomButton.MouseButton1Click:Connect(function()
    local remote = ReplicatedStorage:FindFirstChild("RandomizePetNames")
    if remote then
        remote:FireServer()
    end
end)

--  Custom Mobile Drag for Panel
local dragging = false
local dragInput, startPos, inputStart

panel.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        inputStart = input.Position
        startPos = panel.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

panel.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UIS.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - inputStart
        panel.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X,
            startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
